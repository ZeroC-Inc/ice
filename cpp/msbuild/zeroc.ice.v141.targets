<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) ZeroC, Inc. All rights reserved. -->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!-- Use bin and lib directories that match the used platform toolset -->
    <PropertyGroup Condition="'$(PlatformToolset)' == 'v141'">
        <IceConfiguration Condition="'$(UseDebugLibraries)' == 'true'">Debug</IceConfiguration>
        <IceConfiguration Condition="'$(UseDebugLibraries)' != 'true'">Release</IceConfiguration>
        <LocalDebuggerEnvironment Condition="'$(LocalDebuggerEnvironment)' == ''">PATH=$(MSBuildThisFileDirectory)bin\$(Platform)\$(IceConfiguration)</LocalDebuggerEnvironment>
    </PropertyGroup>

    <ItemDefinitionGroup Condition="'$(PlatformToolset)' == 'v141'">
        <ClCompile>
            <AdditionalIncludeDirectories>$(MSBuildThisFileDirectory)include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
        </ClCompile>
        <Link>
            <AdditionalLibraryDirectories>$(MSBuildThisFileDirectory)lib\$(Platform)\Release;$(MSBuildThisFileDirectory)lib\$(Platform)\Debug;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
        </Link>
    </ItemDefinitionGroup>

    <Target Name="ValidateSliceCompilerVersion" BeforeTargets="CLCompile">
        <Error Text="Detected invalid Ice NuGet package version '$(IceNugetPackageVersion)' expected '3.7.6'"
               Condition="'$(IceNugetPackageVersion)' != '3.7.6'" />
    </Target>

    <Target Name="Ice_CopyDLLs_v141" AfterTargets="Build" Condition="'$(PlatformToolset)' == 'v141' and '$(Ice_CopyDLLs)' == 'Yes'">
        <Copy SourceFiles="$(MSBuildThisFileDirectory)\bin\$(Platform)\$(Configuration)\*.dll"
              DestinationFolder="$(OutDir)"
              SkipUnchangedFiles="true"/>
        <Copy SourceFiles="$(MSBuildThisFileDirectory)\bin\$(Platform)\$(Configuration)\*.pdb"
              DestinationFolder="$(OutDir)"
              SkipUnchangedFiles="true"/>
    </Target>
</Project>
